# Case Study #5: Data Mart

# ðŸŸ¢ 2. Data Exploration

## 1.What day of the week is used for each week_date value?

````sql
select 
		distinct(to_char("week_date",'DAY')) as week_date_day
	from clean_weekly_sales
````
|       | week_date_day | 
|-------|---------------| 
| 1     | MONDAY        | 


## 2.What range of week numbers are missing from the dataset?

````sql
select 
	distinct week_number 
 from clean_weekly_sales
	order by 1 asc
````
| week_number | 
|-------------| 
| 13          | 
| 14          | 
| 15          | 
| 16          | 
| 17          | 
| 18          | 
| 19          | 
| 20          | 
| 21          | 
| 22          | 
| 23          | 
| 24          | 
| 25          | 
| 26          | 
| 27          | 
| 28          | 
| 29          | 
| 30          | 
| 31          | 
| 32          | 
| 33          | 
| 34          | 
| 35          | 
| 36          | 

##  Missing numbers : 1-12 and 37-52


## 3.How many total transactions were there for each year in the dataset?

````sql
select 
	sum(transactions) as total_trancastions,
	calendar_year as for_each_year
from clean_weekly_sales
group by 2
order by 2
````

| for_each_year | total_transactions | 
|---------------|-------------------| 
| 2018          | 346406460         | 
| 2019          | 365639285         | 
| 2020          | 375813651         | 

## 4.What is the total sales for each region for each month?

````sql
select 
	region as for_each_region,
	month_number as for_each_month,
	to_char("week_date", 'MONTH') as month_name,
	sum(sales) as total_sales	
from clean_weekly_sales
group by 1,2,3
order by 1
````
| for_each_region | for_each_month | month_name   | total_sales  |
|-----------------|----------------|--------------|--------------|
| AFRICA          | 5              | MAY          | 1647244738   |
| AFRICA          | 3              | MARCH        | 567767480    |
| AFRICA          | 8              | AUGUST       | 1809596890   |
| AFRICA          | 7              | JULY         | 1960219710   |
| AFRICA          | 9              | SEPTEMBER    | 276320987    |
| AFRICA          | 6              | JUNE         | 1767559760   |
| AFRICA          | 4              | APRIL        | 1911783504   |
| ASIA            | 8              | AUGUST       | 1663320609   |
| ASIA            | 6              | JUNE         | 1619482889   |
| ASIA            | 3              | MARCH        | 529770793    |
| ASIA            | 7              | JULY         | 1768844756   |
| ASIA            | 4              | APRIL        | 1804628707   |
| ASIA            | 5              | MAY          | 1526285399   |
| ASIA            | 9              | SEPTEMBER    | 252836807    |
| CANADA          | 3              | MARCH        | 144634329    |
| CANADA          | 5              | MAY          | 412378365    |
| CANADA          | 7              | JULY         | 477134947    |
| CANADA          | 6              | JUNE         | 443846698    |
| CANADA          | 8              | AUGUST       | 447073019    |
| CANADA          | 4              | APRIL        | 484552594    |
| CANADA          | 9              | SEPTEMBER    | 69067959     |
| EUROPE          | 8              | AUGUST       | 122102995    |
| EUROPE          | 3              | MARCH        | 35337093     |
| EUROPE          | 9              | SEPTEMBER    | 18877433     |
| EUROPE          | 7              | JULY         | 136757466    |
| EUROPE          | 5              | MAY          | 109338389    |
| EUROPE          | 6              | JUNE         | 122813826    |
| EUROPE          | 4              | APRIL        | 127334255    |
| OCEANIA         | 7              | JULY         | 2563459400   |
| OCEANIA         | 5              | MAY          | 2215657304   |
| OCEANIA         | 8              | AUGUST       | 2432313652   |
| OCEANIA         | 4              | APRIL        | 2599767620   |
| OCEANIA         | 6              | JUNE         | 2371884744   |
| OCEANIA         | 9              | SEPTEMBER    | 372465518    |
| OCEANIA         | 3              | MARCH        | 783282888    |
| SOUTH AMERICA   | 6              | JUNE         | 218247455    |
| SOUTH AMERICA   | 8              | AUGUST       | 221166052    |
| SOUTH AMERICA   | 7              | JULY         | 235582776    |
| SOUTH AMERICA   | 5              | MAY          | 201391809    |
| SOUTH AMERICA   | 4              | APRIL        | 238451531    |
| SOUTH AMERICA   | 3              | MARCH        | 71023109     |
| SOUTH AMERICA   | 9              | SEPTEMBER    | 34175583     |
| USA             | 8              | AUGUST       | 712002790    |
| USA             | 6              | JUNE         | 703878990    |
| USA             | 9              | SEPTEMBER    | 110532368    |
| USA             | 7              | JULY         | 760331754    |
| USA             | 4              | APRIL        | 759786323    |
| USA             | 5              | MAY          | 655967121    |
| USA             | 3              | MARCH        | 225353043    |


